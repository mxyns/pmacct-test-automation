!---------------------!
! Generic Settings !
!---------------------!
core_proc_name: nfacctd-00_core 
daemonize: false
debug: true
pidfile: /var/log/pmacct/pmacct_output/nfacctd.pid
logfile: /var/log/pmacct/pmacct_output/nfacctd.log

debug_internal_msg: true

!
timestamps_secs: true
timestamps_since_epoch: true
writer_id_string: $proc_name
!
aggregate[nfacctd-00_kafka]: as_path, dst_host, dst_mask, dst_net, dst_port, ext_comm, fwd_status, in_iface, label, lrg_comm, mpls_label_stack, mpls_tl_ipv4_address, mpls_tl_prefix_length, mpls_tl_type, mpls_vpn_rd, nat_event, out_iface, peer_src_ip, post_nat_dst_host, post_nat_dst_port, post_nat_src_host, post_nat_src_port, proto, src_as_path, src_ext_comm, src_host, src_lrg_comm, src_mask, src_net, src_port, src_std_comm, srhActiveSegmentIPv6, srhFlagsIPv6, srhSegmentIPv6sLeft, srhTagIPv6, std_comm, tcpflags, timestamp_arrival, timestamp_end, timestamp_start, tos, vrf_id_egress, vrf_id_ingress, vrf_name
plugins: kafka
!
maps_index: true
maps_refresh: true
maps_entries: 400000
!
pre_tag_label_encode_as_map: true
pre_tag_map: /var/log/pmacct/pretag.map
flow_to_rd_map: /var/log/pmacct/f2rd-00.map
!
!---------------------!
! IPFIX Settings !
!---------------------!
nfacctd_ip: 0.0.0.0
nfacctd_port: 8989
!
! Overwrite timestamps with pmacct timestamps
nfacctd_time_new: true
nfacctd_pipe_size: 4096000
nfacctd_pro_rating: false 
nfacctd_renormalize: false 
nfacctd_stitching: true
!
aggregate_primitives: /var/log/pmacct/custom-primitives-00.lst
!
tcpflags_encode_as_array: True
fwd_status_encode_as_string: True
mpls_label_stack_encode_as_array: True
!
plugin_pipe_zmq: true
plugin_pipe_zmq_retry: 60
plugin_pipe_zmq_profile: micro 
!
# !---------------------!
# ! Kafka Settings !
# !---------------------!
# kafka_config_file: /etc/pmacct/librdkafka-00.conf
# kafka_topic: daisy.flow
# kafka_output: avro
# kafka_avro_schema_registry: http://127.0.0.1:8081
# avro_buffer_size: 8192
# avro_schema_output_file: /var/log/pmacct/avsc/nfacctd-00.avsc
# !
# kafka_max_writers: 10
# kafka_refresh_time: 60
# kafka_history: 1m
# kafka_history_roundoff: m

#########################
# Plugin Kafka Settings #
#########################

kafka_topic: daisy.dev.flow-avro-raw
kafka_topic[nfacctd-00_kafka]: daisy.dev.flow-avro-raw
kafka_config_file[nfacctd-00_kafka]: /var/log/pmacct/librdkafka.conf
kafka_output[nfacctd-00_kafka]: avro
kafka_avro_schema_registry[nfacctd-00_kafka]: http://schema-registry:8081

# This option defines the size in bytes of the buffer used by the Avro data serialization system.
# The buffer needs to be large enough to store at least a single Avro recorplugin.
avro_buffer_size[nfacctd-00_kafka]: 8192
#avro_schema_output_file: /var/log/pmacct/avsc/flow_avroschema.avsc (obsolete?)
avro_schema_file[nfacctd-00_kafka]: /var/log/pmacct/pmacct_output/flow_avroschema.avsc

# maximum number of concurrent writer processes the plugin is allowed to start.
kafka_max_writers[nfacctd-00_kafka]: 10

# Time interval, in seconds, between consecutive executions of the plugin cache scanner.
kafka_refresh_time[nfacctd-00_kafka]: 60

# Enables historical accounting by placing accounted data into configurable time-bins.
# It does use the stamp_inserted (base time of the time-bin) and stamp_updated (last time
# the time-bin was touched) fields
kafka_history[nfacctd-00_kafka]: 1m

# Enables alignment of minutes (m), hours (h), days of month (d), weeks (w) and months (M)
kafka_history_roundoff[nfacctd-00_kafka]: m
